<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Escanear Código de Barras</title>
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>
  <h2>Escanear código de barras</h2>
  <div id="reader" style="width:300px"></div>
  <div id="result"></div>
  <script>
    // Stock de prueba
    const productos = [
      { codigo: "7799876543210", nombre: "Arroz Gallo", precio: 1200 },
      { codigo: "7798765432109", nombre: "Fideos Lucchetti", precio: 950 },
      { codigo: "7797654321098", nombre: "Aceite Natura", precio: 3500 },
      { codigo: "7796543210987", nombre: "Azúcar Ledesma", precio: 900 }
    ];

    function buscarProducto(codigo) {
      return productos.find(p => p.codigo === codigo);
    }

    function mostrarResultado(codigo) {
      const producto = buscarProducto(codigo);
      const resultDiv = document.getElementById('result');
      if (producto) {
        resultDiv.innerHTML = `<b>Producto:</b> ${producto.nombre}<br><b>Precio:</b> $${producto.precio}`;
      } else {
        resultDiv.innerHTML = `Código ${codigo} no encontrado.`;
      }
    }

    // Inicializar escáner
    const html5QrCode = new Html5Qrcode("reader");
    html5QrCode.start(
      { facingMode: "environment" },
      { fps: 10, qrbox: 250 },
      (decodedText, decodedResult) => {
        mostrarResultado(decodedText);
        html5QrCode.stop();
      }
    ).catch(err => {
      document.getElementById('result').innerText = "Error al iniciar cámara: " + err;
    });
  </script>
</body>
</html>
